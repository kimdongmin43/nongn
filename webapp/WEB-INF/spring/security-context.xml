<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security"
	xmlns:beans="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
http://www.springframework.org/schema/beans/spring-beans.xsd
http://www.springframework.org/schema/security
http://www.springframework.org/schema/security/spring-security-3.2.xsd">
	<http auto-config="true" use-expressions="true" disable-url-rewriting="true" >
    	<custom-filter ref="ajaxSessionTimeoutFilter" after="EXCEPTION_TRANSLATION_FILTER"/>
		<intercept-url pattern="/favicon.ico" access="permitAll" />
		<intercept-url pattern="/img/**" access="permitAll" />
		<intercept-url pattern="/assets/**" access="permitAll" />
		<intercept-url pattern="/css/**" access="permitAll" />
		<intercept-url pattern="/js/**" access="permitAll" />
		<intercept-url pattern="/images/**" access="permitAll" />
		<intercept-url pattern="/html/**" access="permitAll" />
		<intercept-url pattern="/rest/**" access="permitAll" />
		<intercept-url pattern="/index.jsp" access="permitAll"/>
		<intercept-url pattern="/login.do" access="permitAll"/>
		<intercept-url pattern="/user/**" access="permitAll" />
		<intercept-url pattern="/captcha" access="permitAll" />
		<intercept-url pattern="/front/**" access="permitAll" requires-channel="https"/>
		<intercept-url pattern="/back/**" access="hasRole('ROLE_USER')" requires-channel="https"/>
		<intercept-url pattern="/sadm18.do" requires-channel="https"/>

		
		<form-login login-page="/sadm18.do"
			authentication-success-handler-ref="loginSuccessHandler"
			authentication-failure-handler-ref="loginFailureHandler"/>
		<logout invalidate-session="true" logout-success-url="/sadm18.do"></logout>

	    <port-mappings>
           <port-mapping http="8080" https="444"/>
       </port-mappings>

		<access-denied-handler ref="acessDeniedHandler"/>
    	<session-management session-fixation-protection="none"/>
	</http>

	<beans:bean id="ajaxSessionTimeoutFilter" class="kr.apfs.local.login.AjaxSessionCheckFilter">
        <beans:property name="ajaxHeader" value="AJAX" />
    </beans:bean>

	<beans:bean id="loginService" class="kr.apfs.local.login.service.LoginService" />
	<beans:bean id="loginSuccessHandler" class="kr.apfs.local.login.service.LoginSuccessHandler" />
	<beans:bean id="loginFailureHandler" class="kr.apfs.local.login.service.LoginFailureHandler" />
	<beans:bean id="loginAuthenticationProvider" class="kr.apfs.local.login.LoginAuthenticationProvider" />

	<beans:bean id="acessDeniedHandler" class="kr.apfs.local.common.handler.AccessDeniedHandlerImpl">
        <beans:property name="redirect" value="false" />
        <beans:property name="errorPage" value="/login.do" />
    </beans:bean>

	<authentication-manager alias="authenticationManage">
		<authentication-provider ref="loginAuthenticationProvider" />
	</authentication-manager>

</beans:beans>
